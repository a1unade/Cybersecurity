
## Лабораторная работа

Открыл брандмауэр

<img src="./images/1.png">

Проверил настройки

<img src="./images/2.png">

Убедился что сайт открывается, значит соединение установлено

<img src="./images/3.png">

Создаю правило

<img src="./images/4.png">

Делаю также как в документе с лабораторной работой

<img src="./images/5.png">

<img src="./images/6.png">

<img src="./images/7.png">

Для портов 80, 443

<img src="./images/34.png">

<img src="./images/8.png">

<img src="./images/9.png">

<img src="./images/10.png">

Создалось правило, запустил его и попробовал зайти на сайт

<img src="./images/11.png">

<img src="./images/14.png">

Соединения нет, зайти на сайт не получается


отключил и соединение восстановлено.

## Самостоятельная работа

Для выполнения самостоятельной работы запустил две виртуальные машины.

Ip адресса на машинах `192.168.1.1` и `192.168.1.2`

<img src="./images/12.png">

Проверил ping между машинами, все в порядке

<img src="./images/13.png">

На первой машине разрешил все подключения 

<img src="./images/15.png">


## Сканирование узла 192.168.1.1 с помощью Nmap

Далее пробую сделать сканирование на другой машине
Сканирую командой 

```bash
nmap -sV -O -p 1-1000 192.168.1.1
```
со второй машины 
Сканирование `192.168.1.1` с `192.168.1.2` с помощью `Nmap` проведено успешно. TCP

<img src="./images/35.png">

Найдено:

- `23/tcp` `Telnet` `OPEN`

- `80/tcp` `HTTP` `OPEN`

- Остальные 998 портов в диапазоне 1-1000 закрыты (closed).

Определение ОС: 

- Устройство: ZyXEL Keenetic 4G II  (wi-fi роутер)
- ОС: Linux (встроенная прошивка).

Сканирование UDP-портов 192.168.1.1 с 192.168.1.2 проведено успешно.


## UDP сканирование
команда: 

```bash
nmap -sU -p 1-1000 192.168.1.1
```

<img src="./images/16.png">

- `53/udp` `domain` `(DNS) OPEN`

- `67/udp` `dhcps` `OPEN|FILTERED`

Закрытые порты:

- Остальные 998 UDP-портов в диапазоне 1-1000 закрыты (port-unreach).

## Создание правила, блокирующего порты 130-140 (TCP)

<img src="./images/17.png">

Блокирую порты tcp 130-140

<img src="./images/18.png">

<img src="./images/19.png">

Nmap с другой машины дал такой ответ 

<img src="./images/20.png">

Ожидалось `filtered`

## Блокировка ICMP (ping)

<img src="./images/21.png">

<img src="./images/22.png">

Блокировка удалась

<img src="./images/23.png">

## Блокировка всех входящих TCP и UDP пакетов

Создал два правила для блокировки портов `tcp` и `udp` 

<img src="./images/24.png">

провожу сканирование с помощью команды: 

```bash
nmap -sS -sU 192.168.1.1
```

Результат:

<img src="./images/25.png">

## Запрет ICMP только для 192.168.1.2

<img src="./images/26.png">


Запрет ICMP только для 192.168.1.2

- Изменение правила блокировки ICMP:
    - Область → Указать IP-адреса → 192.168.1.2.

Блокируется, как и должно

<img src="./images/27.png">

Меняю ip, для того чтобы обойти правило брандмауэра

<img src="./images/28.png">

Проверяю Ping
Работает

<img src="./images/29.png">

## Анализ трафика в Wireshark

Открыл `WireShark` для захвата трафика
Сканирую командой 

```bash
nmap -p 445 192.168.1.1
```

Обычное сканирование (TCP-connect)

<img src="./images/31.png">

Порт закрыт 
Вот что показал `WireShark`

<img src="./images/30.png">

Второе сканирование 
Команда: 

```bash
nmap -sS -p 445 192.168.1.1
```

SYN-сканирование (полуоткрытое)

<img src="./images/32.png">

Появились еще две записи в `WireShark`

<img src="./images/33.png">

Вывод (`tcp` сканирование):

- Результат идентичен SYN-сканированию, так как порт не принимает соединений.

- В реальной сети разница была бы видна, если порт открыт (SYN-сканирование не завершает handshake, а TCP-connect — завершает).

Вывод (`syn` сканирование):

- Порт 445 закрыт (не слушается сервисом), так как целевая машина отвечает `RST` + `ACK`.

- SYN-сканирование не требует завершения handshake, поэтому Nmap сразу определяет порт как `closed`.

## Итоги

Выполненные работы

### Проверка работы брандмауэра `Windows`

- Проверил доступность сайта при включенном брандмауэре – соединение работает.

- Создал правило для блокировки портов 80 (`HTTP`) и 443 (`HTTPS`).

- После активации правила доступ к сайтам пропал.

- После отключения правила соединение восстановилось.

Вывод: Брандмауэр корректно блокирует трафик по заданным правилам.

### Работа с двумя виртуальными машинами

- Настроил две виртуальные машины с IP-адресами:

    - 192.168.1.1 (роутер ZyXEL Keenetic)
    - 192.168.1.2 (тестовая машина)

- Проверил связность через ping – успешно.

### Сканирование Nmap

- TCP-сканирование (nmap -sV -O -p 1-1000 192.168.1.1)

- Обнаружены открытые порты:

    - `23/tcp` (Telnet) – уязвимость (лучше отключить).

    - `80/tcp` (HTTP) – веб-интерфейс роутера.

    - Остальные порты закрыты.

    - Определена ОС: Linux (ZyXEL Keenetic 4G II).
    
- UDP-сканирование (nmap -sU -p 1-1000 192.168.1.1)

- Обнаружены:

    - `53/udp` (DNS) – открыт.

    - `67/udp` (DHCP) – open|filtered.

    - Остальные UDP-порты закрыты.

### Настройка правил брандмауэра

- Блокировка TCP-портов 130-140

    - После создания правила сканирование (nmap -p 130-140 192.168.1.1) показало filtered (порты заблокированы).

- Блокировка ICMP (ping)

    - Ping с 192.168.1.2 не проходит.

    - Если изменить IP-адрес источника – ping работает.

- Блокировка всех входящих TCP/UDP-пакетов

    - Сканирование (nmap -sS -sU 192.168.1.1) не обнаружило открытых портов.

### Анализ трафика в Wireshark

- Обычное TCP-сканирование (nmap -p 445 192.168.1.1)

    - Wireshark зафиксировал SYN → RST+ACK (порт закрыт).

- SYN-сканирование (nmap -sS -p 445 192.168.1.1)

    - Аналогичный результат, но без завершения TCP-handshake.

Вывод: SYN-сканирование более скрытное, но в данном случае разницы нет, так как порт закрыт.

### Выводы

- Брандмауэр `Windows` эффективно блокирует трафик по заданным правилам.

- `Nmap` позволяет обнаруживать открытые порты и сервисы, а также обходить простые методы фильтрации (например, SYN-сканирование).

- `Wireshark` помогает анализировать сетевой трафик и проверять работу брандмауэра.

## Ответы на вопросы по межсетевым экранам

1. Принципы работы межсетевых экранов

Межсетевые экраны (брандмауэры) выполняют несколько ключевых функций:

- Анализируют и фильтруют сетевой трафик по заданным правилам

- Контролируют доступ к сети на основе IP-адресов, портов и протоколов

- Отслеживают состояние активных соединений (`stateful inspection`)

- Могут выполнять трансляцию сетевых адресов (`NAT`)

- Обеспечивают защиту от сетевых атак

2. Конфигурирование межсетевого экрана Windows

Настройка выполняется через:

- Панель управления → Брандмауэр Защитника Windows

- Приложение "Параметры" → Обновление и безопасность → Брандмауэр Windows

- Консоль управления (`mmc`) с оснасткой "Брандмауэр Windows в режиме повышенной безопасности"

3. Классификация межсетевых экранов

Выделяют несколько типов:

- `Пакетные фильтры` - простейшие, работают на сетевом уровне

- `Шлюзы сеансового уровня` - анализируют состояние соединений

- `Прикладные шлюзы` - проверяют содержимое трафика

- `Многоуровневые` - комбинируют несколько методов проверки

4. Профили брандмауэра

Windows использует три профиля:

1) Домен - для корпоративных сетей с контроллером домена

2) Частный - для доверенных сетей (домашних или рабочих)

3) Общий - для публичных сетей с максимальными ограничениями

5. Состояние брандмауэра

Может быть:

1) Включен (рекомендуется) - все правила активны

2) Отключен (не рекомендуется) - весь трафик разрешен

Проверяется в настройках брандмауэра.

6. Правила соединений

- Входящие правила - управляют внешними подключениями к компьютеру

- Исходящие правила - контролируют доступ программ в интернет

Для каждого можно задать разрешающее или запрещающее действие.

7. Создание исходящего правила

Через мастер создания правил:

1) Выбираем тип правила (для программы, порта или настраиваемое)

2) Указываем параметры (путь к программе, номера портов)

3) Задаем действие (разрешить или заблокировать)

4) Выбираем профили, к которым применяется правило

5) Даем понятное имя правилу